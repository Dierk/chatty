apply from: "$rootDir/gradle/integrationTest.gradle"

buildscript {
    repositories {
        jcenter()
    }
}

task gruntTest(type: GruntTask) {
    group = "Verification"
    description = "Runs the Jasmine unit tests."
    gruntArgs = "test"

    inputs.dir "[relative-path-to-source]"
    inputs.file file("Gruntfile.js")
}

task gruntIntegrationTest(type: GruntTask) {
    group = "Verification"
    description = "Runs the Jasmine integration tests."
    gruntArgs = "itest"

    inputs.dir "[relative-path-to-source]"
    inputs.file file("Gruntfile.js")
}

gruntIntegrationTest.dependsOn ':com.toedter.chatty.server:startServerAsync'
gruntIntegrationTest.mustRunAfter ':com.toedter.chatty.server:integrationTest'
gruntIntegrationTest.finalizedBy(':com.toedter.chatty.server:stopServer')

integrationTest.dependsOn gruntIntegrationTest;
test.dependsOn gruntTest;
